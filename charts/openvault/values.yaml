app-template:
  configMaps:
    backend-config:
      data:
        DJANGO_SETTINGS_MODULE: ov_wag.settings.production
        OV_ALLOWED_HOSTS: '*'
        OV_TRUSTED_ORIGINS: https://admin.ov.wgbh-mla.org,http://localhost:8000
        OV_DEBUG: 'false'
        OV_CSRF_COOKIE_SECURE: 'false'
        OV_API_URL: http://ov-wag/api/v2
        OV_BASE_URL: https://openvault.wgbh.org
        OV_ADMIN_BASE_URL: https://admin.ov.wgbh-mla.org
        OV_HOST: '0.0.0.0:8000'
        OV_WORKERS: '1'
        OV_FORWARDED_ALLOW_IPS: '*'
        OV_ACCESS_LOGFILE: '-'
        OV_ERROR_LOGFILE: '-'
        OV_PREVIEW_URL: https://openvault.wgbh.org/preview
        AWS_STORAGE_BUCKET_NAME: media.openvault.wgbh.org
    frontend-config:
      data:
        NODE_ENV: production
        OV_API_URL: http://ov-wag
        AAPB_HOST: https://americanarchive.org
        ORGAN_URL: http://organ.organ
        ES_URL: https://elastic.wgbh-mla.org
  persistence:
    backend-config:
      type: configMap
      identifier: backend-config
    frontend-config:
      type: configMap
      identifier: frontend-config

  controllers:
    backend:
      containers:
        backend:
          image:
            repository: ghcr.io/wgbh-mla/ov-wag
            tag: v1.0.0
          envFrom:
            - secretRef:
                name: backend-secret
            - configMap: backend-config
    frontend:
      containers:
        frontend:
          image:
            repository: ghcr.io/wgbh-mla/ov-frontend
            tag: main
          envFrom:
            - configMap: frontend-config
  service:
    backend:
      controller: backend
      ports:
        http:
          port: 80
          targetPort: 8000
    frontend:
      controller: frontend
      ports:
        http:
          port: 80
          targetPort: 3000